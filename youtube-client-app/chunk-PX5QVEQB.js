import{a as Y,g as et,h as rt}from"./chunk-HKO5AIAF.js";import{f as G}from"./chunk-QSIMU3VX.js";import{a as it}from"./chunk-BI26IKOA.js";import{a as tt}from"./chunk-GLNEXNYT.js";import{a as Z}from"./chunk-3TOEN4PV.js";import{n as K,o as X,u as E}from"./chunk-DBUPZQWJ.js";import{$ as Q,Aa as h,Ea as A,H as S,I as B,Ja as C,Ka as w,Na as I,Pa as V,Qa as F,Ra as z,T as b,W as x,Za as W,_a as O,aa as U,ab as P,e as T,ja as s,ka as u,kb as H,mb as M,n as L,ob as J,q as k,qa as f,r as j,sa as l,u as R,ua as d,va as a,wa as y,xa as q,y as $,za as N}from"./chunk-TJ4IWNL2.js";var ot=(()=>{let e=class e{transform(r,i,o){if(!r||!i)return r;if(!["date","count"].includes(i))return console.error(`Invalid sortField: ${i}`),r;let p=m=>{switch(i){case"date":return m.snippet?.publishedAt?new Date(m.snippet.publishedAt).getTime():0;case"count":return m.statistics?.viewCount?+m.statistics.viewCount:0;default:return 0}};return r.slice().sort((m,g)=>{let v=p(m),_=p(g);return o==="asc"?v-_:_-v})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=x({name:"sortVideos",type:e,pure:!1,standalone:!0});let t=e;return t})();var nt=(()=>{let e=class e{transform(r,i){if(!r||!i)return r;let o=i.toLowerCase().split(" ");return r.filter(c=>{let p=c.snippet.title.toLowerCase(),m=c.snippet.description.toLowerCase(),g=c.snippet.tags||[];return o.every(v=>p.includes(v)||m.includes(v)||g.some(_=>_.toLowerCase().includes(v)))})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=x({name:"filterVideos",type:e,pure:!1,standalone:!0});let t=e;return t})();var st=(()=>{let e=class e{transform(r,i){if(!r||!i)return r;let o=i.toLowerCase().split(" ");return r.filter(c=>{let p=c.title.toLowerCase(),m=c.description.toLowerCase();return o.every(g=>p.includes(g)||m.includes(g))})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=x({name:"filterCustomCards",type:e,pure:!1,standalone:!0});let t=e;return t})();function mt(t,e){if(t&1){let n=q();d(0,"article",2)(1,"div",3)(2,"div",4),y(3,"img",5),a(),d(4,"div",6)(5,"div",7),C(6),a(),d(7,"div",8),C(8),a(),d(9,"div",8),C(10),a()(),d(11,"div",9)(12,"app-custom-button",10),N("buttonClick",function(){Q(n);let i=h();return U(i.navigateToDetail())}),C(13,"more... "),a()()()()}if(t&2){let n=h();s(3),A("alt"," ",n.customCard.imageUrl," "),s(3),w(n.customCard.title),s(2),w(n.customCard.description),s(2),w(n.customCard.creationDate)}}var at=(()=>{let e=class e{constructor(r){this.router=r}navigateToDetail(){this.customCard&&this.router.navigate(["youtube","detailed-information",this.customCard.id])}};e.\u0275fac=function(i){return new(i||e)(u(M))},e.\u0275cmp=b({type:e,selectors:[["app-custom-card"]],inputs:{customCard:"customCard"},standalone:!0,features:[I],decls:2,vars:2,consts:[["class","custom-card",4,"ngIf"],[1,"custom-card-line",3,"appDateBackground"],[1,"custom-card"],[1,"custom-card-container"],[1,"custom-card-image"],["src","Image Pucture",3,"alt"],[1,"custom-card-about"],[1,"custom-card-title"],[1,"custom-card-description"],[1,"search-item-more"],["buttonClass","button-search-item-more",3,"buttonClick"]],template:function(i,o){i&1&&(f(0,mt,14,5,"article",0),y(1,"span",1)),i&2&&(l("ngIf",o.customCard),s(),l("appDateBackground",o.customCard==null||o.customCard.creationDate==null?null:o.customCard.creationDate.toISOString()))},dependencies:[P,O,Z,J],styles:[".custom-card[_ngcontent-%COMP%]{padding:20px;border:2px solid #c18183;border-radius:5px;max-width:264px;height:100%;background:linear-gradient(120deg,ivory,gold)}.custom-card-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.custom-card-image[_ngcontent-%COMP%]:not(:last-child){margin-bottom:21px}.custom-card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:224px;height:124px}.custom-card-about[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;flex-grow:1;font-size:20px;font-weight:700}.custom-card-about[_ngcontent-%COMP%]:not(:last-child){margin-bottom:59px}.search-item-more[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-top:auto}.custom-card-line[_ngcontent-%COMP%]{display:block;height:5px;background-color:#2f80ed;margin-top:-5px;border-radius:2px}"]});let t=e;return t})();var ct=X(t=>t.customCards,t=>t);function pt(t,e){if(t&1&&(d(0,"div"),y(1,"app-custom-card",5),a()),t&2){let n=e.$implicit;s(),l("customCard",n)}}function ut(t,e){if(t&1&&(d(0,"div"),f(1,pt,2,1,"div",4),V(2,"filterCustomCards"),a()),t&2){let n=h(2);s(),l("ngForOf",F(2,1,n.filteredCustomCards,n.searchQueryWords))}}function ft(t,e){if(t&1&&(d(0,"div"),y(1,"app-search-item",7),a()),t&2){let n=e.$implicit;s(),l("videoData",n)}}function ht(t,e){if(t&1&&(d(0,"div",6),f(1,ft,2,1,"div",4),V(2,"sortVideos"),V(3,"filterVideos"),a()),t&2){let n=h(2);s(),l("ngForOf",F(3,5,z(2,1,n.filteredVideos,n.sortField,n.sortOrder),n.searchQueryWords))}}function Ct(t,e){t&1&&(d(0,"div"),C(1," No results found. "),a())}function gt(t,e){if(t&1&&(d(0,"div")(1,"div",2),f(2,ut,3,4,"div",1),a(),f(3,ht,4,8,"div",3)(4,Ct,2,0,"div",1),a()),t&2){let n=h();s(2),l("ngIf",n.filteredCustomCards&&n.filteredCustomCards.length),s(),l("ngIf",n.filteredVideos&&n.filteredVideos.length),s(),l("ngIf",!n.customCards.length&&!n.filteredVideos.length)}}var qt=(()=>{let e=class e{constructor(r,i,o,c,p){this.router=r,this.route=i,this.searchService=o,this.sortService=c,this.store=p,this.filteredVideos=[],this.filteredCustomCards=[],this.searchResultsVisible=!1,this.destroy$=new T,this.searchControl=new G(""),this.customCards=[]}ngOnInit(){this.store.subscribe(o=>{console.log("Current state:",o)}),this.customCards$=this.store.select(ct),console.log("Initialized customCards$:",this.customCards$);let r=this.searchService.searchQuery$.pipe(R(E),j(o=>o!==null&&o.length>2),$()),i=this.route.queryParams.pipe(R(E),$((o,c)=>o.search===c.search),L(o=>o.search??""));k(r,i).pipe(S(this.destroy$),B(o=>{let c=o??"";this.updateSearchQueryInURL(c),this.store.dispatch(Y({query:c}))})).subscribe(),this.filteredVideos$=this.store.select(et("")),this.filteredVideos$.pipe(S(this.destroy$)).subscribe(o=>{this.filteredVideos=o,console.log(this.filteredVideos),this.updateSearchResultsVisibility()}),this.customCards$.pipe(S(this.destroy$)).subscribe(o=>{console.log("Received customCards:",o),this.filteredCustomCards=o||[],console.log(this.filteredCustomCards),this.updateSearchResultsVisibility()})}updateSearchQueryInURL(r){this.router.navigate([],{relativeTo:this.route,queryParams:{search:r},queryParamsHandling:"merge"})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}filterCustomCards(r){this.filteredCustomCards=this.filteredCustomCards.filter(i=>i.title.toLowerCase().includes(r.toLowerCase()))}updateSearchResultsVisibility(){this.searchResultsVisible=this.filteredCustomCards.length>0||this.filteredVideos.length>0}get sortField(){return this.sortService.getSortField}get sortOrder(){return this.sortService.getSortOrder}get searchQueryWords(){return this.sortService.getSearchQueryWords}};e.\u0275fac=function(i){return new(i||e)(u(M),u(H),u(it),u(rt),u(K))},e.\u0275cmp=b({type:e,selectors:[["app-search-results"]],standalone:!0,features:[I],decls:2,vars:1,consts:[[1,"main-search-container"],[4,"ngIf"],[1,"custom-card-list-container"],["class","video-list-container",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"customCard"],[1,"video-list-container"],[3,"videoData"]],template:function(i,o){i&1&&(d(0,"div",0),f(1,gt,5,3,"div",1),a()),i&2&&(s(),l("ngIf",o.searchResultsVisible))},dependencies:[P,W,O,tt,ot,nt,at,st],styles:[".video-list-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.main-search-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.custom-card-list-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.custom-card-list-container[_ngcontent-%COMP%]:not(:last-child){margin-bottom:30px}"]});let t=e;return t})();export{qt as SearchResultsComponent};
